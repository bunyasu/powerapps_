"'Select Item Form Screen' As screen":

    lbl_HeaderSIFS As label:
        Color: =RGBA(255, 255, 255, 1)
        Fill: =RGBA(218, 48, 27, 1)
        Height: =77
        PaddingLeft: =100
        Size: =25
        Text: ="フォーム作成（選択肢定義）"
        Width: =1366
        ZIndex: =7

    Canvas1_2 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =Parent.Height - Self.Y
        Width: =Parent.Width
        Y: =lbl_HeaderSIFS.Y + lbl_HeaderSIFS.Height
        ZIndex: =8

        DataCard10 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =365 * CountRows(col_formItem)
            Width: =1366
            X: =0
            Y: =1
            ZIndex: =2

            Gal_SelectItemSetting As gallery.galleryVertical:
                Height: =365 * CountRows(col_formItem)
                Items: =SortByColumns(col_formItem,"order",Ascending)
                Layout: =Layout.Vertical
                TemplateSize: =280 + Max(col_formItem,num) * 40
                Width: =1366
                ZIndex: =1

                Lbl_FormItemNumber As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Fill: =RGBA(90, 90, 90, 1)
                    Height: =41
                    OnSelect: =Select(Parent)
                    Text: ="項目" & ThisItem.order
                    Width: =Parent.Width
                    X: =4
                    ZIndex: =1

                "'Grp Form Item Contents' As group":
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =7

                    Lbl_FormItemContents As label:
                        Color: =RGBA(90, 90, 90, 1)
                        OnSelect: =Select(Parent)
                        Text: ="■　項目内容"
                        X: =4
                        Y: =81
                        ZIndex: =4

                    Lbl_FormItemContentsValue As label:
                        BorderColor: =RGBA(90, 90, 90, 1)
                        OnSelect: =Select(Parent)
                        Text: =ThisItem.contents
                        Width: =981
                        X: =154
                        Y: =81
                        ZIndex: =5

                "'Grp Form Item Type' As group":
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =7

                    Lbl_FormItemType As label:
                        Color: =RGBA(90, 90, 90, 1)
                        OnSelect: =Select(Parent)
                        Text: ="■　項目形態"
                        X: =4
                        Y: =41
                        ZIndex: =2

                    Lbl_FormItemTypeValue As label:
                        BorderColor: =RGBA(90, 90, 90, 1)
                        OnSelect: =Select(Parent)
                        Text: =ThisItem.type
                        Width: =981
                        X: =154
                        Y: =41
                        ZIndex: =3

                "'Grp Form Item Select' As group":
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =7

                    Gal_FormItemSelect As gallery.galleryVertical:
                        BorderColor: =RGBA(90, 90, 90, 1)
                        Height: =200
                        Items: =SortByColumns(Filter(col_selectItem,order = ThisItem.order),"id",Ascending)
                        Layout: =Layout.Vertical
                        TemplateSize: =51
                        Visible: =If(ThisItem.type = "自由入力形式" || ThisItem.type = "添付ファイル形式",false,true)
                        Width: =1179
                        X: =154
                        Y: =121
                        ZIndex: =1

                        Lbl_FormItemSelectNumber As label:
                            BorderColor: =RGBA(90, 90, 90, 1)
                            Color: =RGBA(90, 90, 90, 1)
                            OnSelect: =Select(Parent)
                            Text: =ThisItem.id & "."
                            Width: =50
                            Y: =4
                            ZIndex: =1

                        Txt_FormItemSelectValue As text:
                            BorderColor: =RGBA(90, 90, 90, 1)
                            Default: =ThisItem.name
                            HoverBorderColor: =RGBA(90, 90, 90, 1)
                            OnChange: |-
                                =Patch(col_selectItem,ThisItem,{name:Self.Text});
                            OnSelect: =Select(Parent)
                            Width: =1050
                            X: =50
                            Y: =4
                            ZIndex: =2

                    Lbl_FormItemSelect As label:
                        BorderColor: =RGBA(90, 90, 90, 1)
                        Height: =159
                        OnSelect: =Select(Parent)
                        Text: ="■　選択肢"
                        Visible: =If(ThisItem.type = "自由入力形式" || ThisItem.type = "添付ファイル形式",false,true)
                        X: =4
                        Y: =121
                        ZIndex: =6

                "'Grp Form Item Select Limit Count' As group":
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =9

                    Label1 As label:
                        BorderColor: =RGBA(90, 90, 90, 1)
                        Color: =RGBA(90, 90, 90, 1)
                        OnSelect: =Select(Parent)
                        Text: ="選択数制御"
                        Visible: =ThisItem.type = "複数選択形式"
                        X: =4
                        Y: =320
                        ZIndex: =7

                    Drp_AddFormItem_1 As dropdown:
                        BorderColor: =RGBA(90, 90, 90, 1)
                        ChevronBackground: =RGBA(90, 90, 90, 1)
                        Color: =RGBA(90, 90, 90, 1)
                        Default: =ThisItem.limitCount
                        Items: =Sequence(99,1)
                        OnChange: |-
                            =Patch(col_formItem,ThisItem,{limitCount:Self.Selected.Value})
                        PressedFill: =RGBA(90, 90, 90, 1)
                        SelectionFill: =RGBA(90, 90, 90, 1)
                        Visible: =ThisItem.type = "複数選択形式"
                        Width: =75
                        X: =154
                        Y: =320
                        ZIndex: =8

                "'Grp Form Item Select Limit Type' As group":
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =11

                    Label2 As label:
                        BorderColor: =RGBA(90, 90, 90, 1)
                        Color: =RGBA(90, 90, 90, 1)
                        OnSelect: =Select(Parent)
                        Text: ="選択数制御タイプ"
                        Visible: =ThisItem.type = "複数選択形式"
                        X: =302
                        Y: =320
                        ZIndex: =9

                    Dropdown1 As dropdown:
                        BorderColor: =RGBA(90, 90, 90, 1)
                        ChevronBackground: =RGBA(90, 90, 90, 1)
                        Default: =ThisItem.limitType
                        Items: =Choices(項目定義.選択肢制御タイプ).Value
                        OnChange: |-
                            =Patch(col_formItem,ThisItem,{limitType:Self.Selected.Value})
                        OnSelect: =Select(Parent)
                        PressedFill: =RGBA(90, 90, 90, 1)
                        SelectionFill: =RGBA(90, 90, 90, 1)
                        Visible: =ThisItem.type = "複数選択形式"
                        X: =452
                        Y: =320
                        ZIndex: =10

        DataCard11 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =100
            Width: =1366
            X: =0
            Y: =2
            ZIndex: =3

            Group1 As group:
                Height: =5
                Width: =5
                X: =-239
                Y: =-656
                ZIndex: =5

                Button1 As button:
                    Fill: =RGBA(90, 90, 90, 1)
                    OnSelect: |-
                        =SubmitForm(Frm_BasicInformation);
                        UpdateContext({loc_LastSubmit: Frm_BasicInformation.LastSubmit});
                        ForAll(
                            col_formItem As Local,
                            If(
                                IsBlank(
                                    LookUp(
                                        項目定義,
                                        項目ID = Local.unique
                                    )
                                ),
                                //データ登録
                                Patch(
                                    項目定義,
                                    Defaults(項目定義),
                                    {
                                        項目形態: Switch(
                                            Local.type,
                                            "Yes/No形式",
                                            [@項目形態].'Yes/No形式',
                                            "択一形式",
                                            [@項目形態].択一形式,
                                            "複数選択形式",
                                            [@項目形態].複数選択形式,
                                            "添付ファイル形式",
                                            [@項目形態].添付ファイル形式,
                                            [@項目形態].自由入力形式
                                        ),
                                        CSV出力項目: Local.csv,
                                        内容: Local.contents,
                                        必須: Local.required,
                                        項目番号: Local.order,
                                        選択数: Local.num,
                                        親フォーム: LookUp(
                                            基本情報,
                                            フォームNo = loc_LastSubmit.フォームNo
                                        ),
                                        選択数制御: Local.limitCount,
                                        選択肢制御タイプ: Switch(
                                            Local.limitType,
                                            "無し",
                                            [@選択肢制御タイプ].無し,
                                            "指定数",
                                            [@選択肢制御タイプ].指定数,
                                            "指定数以下",
                                            [@選択肢制御タイプ].指定数以下
                                        )
                                    }
                                );
                                With(
                                    {
                                        ItemID: LookUp(
                                            項目定義,
                                            親フォーム.フォームNo = loc_LastSubmit.フォームNo && 項目番号 = Local.order
                                        )
                                    },
                                    If(
                                        Local.type = "Yes/No形式" || Local.type = "択一形式" || Local.type = "複数選択形式",
                                        ForAll(
                                            Filter(
                                                col_selectItem,
                                                order = Local.order
                                            ) As LocalSelectItem,
                                            Patch(
                                                選択肢列,
                                                Defaults(選択肢列),
                                                {
                                                    親項目: ItemID,
                                                    選択内容: LocalSelectItem.name,
                                                    選択順序: LocalSelectItem.id
                                                }
                                            )
                                        )
                                    )
                                ),
                                //データ更新
                                Patch(
                                    項目定義,
                                    LookUp(
                                        項目定義,
                                        項目ID = Local.unique
                                    ),
                                    {
                                        項目形態: Switch(
                                            Local.type,
                                            "Yes/No形式",
                                            [@項目形態].'Yes/No形式',
                                            "択一形式",
                                            [@項目形態].択一形式,
                                            "複数選択形式",
                                            [@項目形態].複数選択形式,
                                            "添付ファイル形式",
                                            [@項目形態].添付ファイル形式,
                                            [@項目形態].自由入力形式
                                        ),
                                        CSV出力項目: Local.csv,
                                        内容: Local.contents,
                                        必須: Local.required,
                                        項目番号: Local.order,
                                        選択数: Local.num,
                                        親フォーム: LookUp(
                                            基本情報,
                                            フォームNo = loc_LastSubmit.フォームNo
                                        ),
                                        選択数制御: Local.limitCount,
                                        選択肢制御タイプ: Switch(
                                            Local.limitType,
                                            "無し",
                                            [@選択肢制御タイプ].無し,
                                            "指定数",
                                            [@選択肢制御タイプ].指定数,
                                            "指定数以下",
                                            [@選択肢制御タイプ].指定数以下
                                        )
                                    }
                                );
                                If(
                                    Local.type = "Yes/No形式" || Local.type = "択一形式" || Local.type = "複数選択形式",
                                    ForAll(
                                        Filter(
                                            col_selectItem,
                                            order = Local.order
                                        ) As LocalSelectItem,
                                        Patch(
                                            選択肢列,
                                            LookUp(
                                                選択肢列,
                                                選択肢ID = LocalSelectItem.unique
                                            ),
                                            {
                                                親項目: LookUp(
                                                    項目定義,
                                                    項目ID = Local.unique
                                                ),
                                                選択内容: LocalSelectItem.name,
                                                選択順序: LocalSelectItem.id
                                            }
                                        )
                                    )
                                )
                            )
                        );
                        ForAll(
                            col_deleteFormItem As deleteItem,
                            If(
                                !IsBlank(
                                    LookUp(
                                        項目定義,
                                        項目ID = deleteItem.unique
                                    )
                                ),
                                If(
                                    deleteItem.type = "Yes/No形式" || deleteItem.type = "択一形式" || deleteItem.type = "複数選択形式",
                                    ForAll(
                                        Filter(
                                            col_selectItem,
                                            order = deleteItem.order
                                        ) As LocalSelectItem,
                                        Remove(
                                            選択肢列,
                                            LookUp(
                                                選択肢列,
                                                選択肢ID = LocalSelectItem.unique
                                            )
                                        )
                                    )
                                );
                                Remove(
                                    項目定義,
                                    LookUp(
                                        項目定義,
                                        項目ID = deleteItem.unique
                                    )
                                )
                            )
                        );
                        フォーム制定部室店承認通知WF.Run(loc_LastSubmit.フォームNo);
                        Refresh(基本情報);
                        Navigate('Form Gallery Screen',Fade)
                    Text: ="申請"
                    Visible: =Text(DataCardValue3.Selected.Value) <> "承認待ち"
                    X: =301
                    Y: =40
                    ZIndex: =1

                Button3 As button:
                    Fill: =RGBA(90, 90, 90, 1)
                    OnSelect: |-
                        =SubmitForm(Frm_BasicInformation);
                        UpdateContext({loc_LastSubmit: Frm_BasicInformation.LastSubmit});
                        Patch(
                            基本情報,
                            loc_LastSubmit,
                            {状況: 状況.ドラフト}
                        );
                        ForAll(
                            col_formItem As Local,
                            If(
                                IsBlank(
                                    LookUp(
                                        項目定義,
                                        項目ID = Local.unique
                                    )
                                ),
                                //データ登録
                                Patch(
                                    項目定義,
                                    Defaults(項目定義),
                                    {
                                        項目形態: Switch(
                                            Local.type,
                                            "Yes/No形式",
                                            [@項目形態].'Yes/No形式',
                                            "択一形式",
                                            [@項目形態].択一形式,
                                            "複数選択形式",
                                            [@項目形態].複数選択形式,
                                            "添付ファイル形式",
                                            [@項目形態].添付ファイル形式,
                                            [@項目形態].自由入力形式
                                        ),
                                        CSV出力項目: Local.csv,
                                        内容: Local.contents,
                                        必須: Local.required,
                                        項目番号: Local.order,
                                        選択数: Local.num,
                                        親フォーム: LookUp(
                                            基本情報,
                                            フォームNo = loc_LastSubmit.フォームNo
                                        ),
                                        選択数制御: Local.limitCount,
                                        選択肢制御タイプ: Switch(
                                            Local.limitType,
                                            "無し",
                                            [@選択肢制御タイプ].無し,
                                            "指定数",
                                            [@選択肢制御タイプ].指定数,
                                            "指定数以下",
                                            [@選択肢制御タイプ].指定数以下
                                        )
                                    }
                                );
                                With(
                                    {
                                        ItemID: LookUp(
                                            項目定義,
                                            親フォーム.フォームNo = loc_LastSubmit.フォームNo && 項目番号 = Local.order
                                        )
                                    },
                                    If(
                                        Local.type = "Yes/No形式" || Local.type = "択一形式" || Local.type = "複数選択形式",
                                        ForAll(
                                            Filter(
                                                col_selectItem,
                                                order = Local.order
                                            ) As LocalSelectItem,
                                            Patch(
                                                選択肢列,
                                                Defaults(選択肢列),
                                                {
                                                    親項目: ItemID,
                                                    選択内容: LocalSelectItem.name,
                                                    選択順序: LocalSelectItem.id
                                                }
                                            )
                                        )
                                    )
                                ),
                                //データ更新
                                Patch(
                                    項目定義,
                                    LookUp(
                                        項目定義,
                                        項目ID = Local.unique
                                    ),
                                    {
                                        項目形態: Switch(
                                            Local.type,
                                            "Yes/No形式",
                                            [@項目形態].'Yes/No形式',
                                            "択一形式",
                                            [@項目形態].択一形式,
                                            "複数選択形式",
                                            [@項目形態].複数選択形式,
                                            "添付ファイル形式",
                                            [@項目形態].添付ファイル形式,
                                            [@項目形態].自由入力形式
                                        ),
                                        CSV出力項目: Local.csv,
                                        内容: Local.contents,
                                        必須: Local.required,
                                        項目番号: Local.order,
                                        選択数: Local.num,
                                        親フォーム: LookUp(
                                            基本情報,
                                            フォームNo = loc_LastSubmit.フォームNo
                                        ),
                                        選択数制御: Local.limitCount,
                                        選択肢制御タイプ: Switch(
                                            Local.limitType,
                                            "無し",
                                            [@選択肢制御タイプ].無し,
                                            "指定数",
                                            [@選択肢制御タイプ].指定数,
                                            "指定数以下",
                                            [@選択肢制御タイプ].指定数以下
                                        )
                                    }
                                );
                                If(
                                    Local.type = "Yes/No形式" || Local.type = "択一形式" || Local.type = "複数選択形式",
                                    ForAll(
                                        Filter(
                                            col_selectItem,
                                            order = Local.order
                                        ) As LocalSelectItem,
                                        Patch(
                                            選択肢列,
                                            LookUp(
                                                選択肢列,
                                                選択肢ID = LocalSelectItem.unique
                                            ),
                                            {
                                                親項目: LookUp(
                                                    項目定義,
                                                    項目ID = Local.unique
                                                ),
                                                選択内容: LocalSelectItem.name,
                                                選択順序: LocalSelectItem.id
                                            }
                                        )
                                    )
                                )
                            )
                        );
                        ForAll(
                            col_deleteFormItem As deleteItem,
                            If(
                                !IsBlank(
                                    LookUp(
                                        項目定義,
                                        項目ID = deleteItem.unique
                                    )
                                ),
                                If(
                                    deleteItem.type = "Yes/No形式" || deleteItem.type = "択一形式" || deleteItem.type = "複数選択形式",
                                    ForAll(
                                        Filter(
                                            col_selectItem,
                                            order = deleteItem.order
                                        ) As LocalSelectItem,
                                        Remove(
                                            選択肢列,
                                            LookUp(
                                                選択肢列,
                                                選択肢ID = LocalSelectItem.unique
                                            )
                                        )
                                    )
                                );
                                Remove(
                                    項目定義,
                                    LookUp(
                                        項目定義,
                                        項目ID = deleteItem.unique
                                    )
                                )
                            )
                        );
                        Refresh(基本情報);
                        Navigate('Form Gallery Screen',Fade)
                    Text: ="ドラフト"
                    Visible: =Text(DataCardValue3.Selected.Value) <> "承認待ち"
                    X: =824
                    Y: =40
                    ZIndex: =2

                Button4 As button:
                    Fill: =RGBA(90, 90, 90, 1)
                    OnSelect: |-
                        =SubmitForm(Frm_BasicInformation);
                        UpdateContext({loc_LastSubmit: Frm_BasicInformation.LastSubmit});
                        /*
                        Patch(
                            基本情報,
                            loc_LastSubmit,
                            {状況: 状況.ドラフト}
                        );
                        */
                        ForAll(
                            col_formItem As Local,
                            If(
                                IsBlank(
                                    LookUp(
                                        項目定義,
                                        項目ID = Local.unique
                                    )
                                ),
                                //データ登録
                                Patch(
                                    項目定義,
                                    Defaults(項目定義),
                                    {
                                        項目形態: Switch(
                                            Local.type,
                                            "Yes/No形式",
                                            [@項目形態].'Yes/No形式',
                                            "択一形式",
                                            [@項目形態].択一形式,
                                            "複数選択形式",
                                            [@項目形態].複数選択形式,
                                            "添付ファイル形式",
                                            [@項目形態].添付ファイル形式,
                                            [@項目形態].自由入力形式
                                        ),
                                        CSV出力項目: Local.csv,
                                        内容: Local.contents,
                                        必須: Local.required,
                                        項目番号: Local.order,
                                        選択数: Local.num,
                                        親フォーム: LookUp(
                                            基本情報,
                                            フォームNo = loc_LastSubmit.フォームNo
                                        ),
                                        選択数制御: Local.limitCount,
                                        選択肢制御タイプ: Switch(
                                            Local.limitType,
                                            "無し",
                                            [@選択肢制御タイプ].無し,
                                            "指定数",
                                            [@選択肢制御タイプ].指定数,
                                            "指定数以下",
                                            [@選択肢制御タイプ].指定数以下
                                        )
                                    }
                                );
                                With(
                                    {
                                        ItemID: LookUp(
                                            項目定義,
                                            親フォーム.フォームNo = loc_LastSubmit.フォームNo && 項目番号 = Local.order
                                        )
                                    },
                                    If(
                                        Local.type = "Yes/No形式" || Local.type = "択一形式" || Local.type = "複数選択形式",
                                        ForAll(
                                            Filter(
                                                col_selectItem,
                                                order = Local.order
                                            ) As LocalSelectItem,
                                            Patch(
                                                選択肢列,
                                                Defaults(選択肢列),
                                                {
                                                    親項目: ItemID,
                                                    選択内容: LocalSelectItem.name,
                                                    選択順序: LocalSelectItem.id
                                                }
                                            )
                                        )
                                    )
                                ),
                                //データ更新
                                Patch(
                                    項目定義,
                                    LookUp(
                                        項目定義,
                                        項目ID = Local.unique
                                    ),
                                    {
                                        項目形態: Switch(
                                            Local.type,
                                            "Yes/No形式",
                                            [@項目形態].'Yes/No形式',
                                            "択一形式",
                                            [@項目形態].択一形式,
                                            "複数選択形式",
                                            [@項目形態].複数選択形式,
                                            "添付ファイル形式",
                                            [@項目形態].添付ファイル形式,
                                            [@項目形態].自由入力形式
                                        ),
                                        CSV出力項目: Local.csv,
                                        内容: Local.contents,
                                        必須: Local.required,
                                        項目番号: Local.order,
                                        選択数: Local.num,
                                        親フォーム: LookUp(
                                            基本情報,
                                            フォームNo = loc_LastSubmit.フォームNo
                                        ),
                                        選択数制御: Local.limitCount,
                                        選択肢制御タイプ: Switch(
                                            Local.limitType,
                                            "無し",
                                            [@選択肢制御タイプ].無し,
                                            "指定数",
                                            [@選択肢制御タイプ].指定数,
                                            "指定数以下",
                                            [@選択肢制御タイプ].指定数以下
                                        )
                                    }
                                );
                                If(
                                    Local.type = "Yes/No形式" || Local.type = "択一形式" || Local.type = "複数選択形式",
                                    ForAll(
                                        Filter(
                                            col_selectItem,
                                            order = Local.order
                                        ) As LocalSelectItem,
                                        Patch(
                                            選択肢列,
                                            LookUp(
                                                選択肢列,
                                                選択肢ID = LocalSelectItem.unique
                                            ),
                                            {
                                                親項目: LookUp(
                                                    項目定義,
                                                    項目ID = Local.unique
                                                ),
                                                選択内容: LocalSelectItem.name,
                                                選択順序: LocalSelectItem.id
                                            }
                                        )
                                    )
                                )
                            )
                        );
                        ForAll(
                            col_deleteFormItem As deleteItem,
                            If(
                                !IsBlank(
                                    LookUp(
                                        項目定義,
                                        項目ID = deleteItem.unique
                                    )
                                ),
                                If(
                                    deleteItem.type = "Yes/No形式" || deleteItem.type = "択一形式" || deleteItem.type = "複数選択形式",
                                    ForAll(
                                        Filter(
                                            col_selectItem,
                                            order = deleteItem.order
                                        ) As LocalSelectItem,
                                        Remove(
                                            選択肢列,
                                            LookUp(
                                                選択肢列,
                                                選択肢ID = LocalSelectItem.unique
                                            )
                                        )
                                    )
                                );
                                Remove(
                                    項目定義,
                                    LookUp(
                                        項目定義,
                                        項目ID = deleteItem.unique
                                    )
                                )
                            )
                        );
                        Refresh(基本情報);
                        Navigate('Form Gallery Screen',Fade)
                    Text: ="差し戻し"
                    Visible: =Text(DataCardValue3.Selected.Value) = "承認待ち"
                    X: =651
                    Y: =40
                    ZIndex: =3

                Button4_1 As button:
                    Fill: =RGBA(90, 90, 90, 1)
                    OnSelect: |-
                        =SubmitForm(Frm_BasicInformation);
                        UpdateContext({loc_LastSubmit: Frm_BasicInformation.LastSubmit});
                        ForAll(
                            col_formItem As Local,
                            If(
                                IsBlank(
                                    LookUp(
                                        項目定義,
                                        項目ID = Local.unique
                                    )
                                ),
                                //データ登録
                                Patch(
                                    項目定義,
                                    Defaults(項目定義),
                                    {
                                        項目形態: Switch(
                                            Local.type,
                                            "Yes/No形式",
                                            [@項目形態].'Yes/No形式',
                                            "択一形式",
                                            [@項目形態].択一形式,
                                            "複数選択形式",
                                            [@項目形態].複数選択形式,
                                            "添付ファイル形式",
                                            [@項目形態].添付ファイル形式,
                                            [@項目形態].自由入力形式
                                        ),
                                        CSV出力項目: Local.csv,
                                        内容: Local.contents,
                                        必須: Local.required,
                                        項目番号: Local.order,
                                        選択数: Local.num,
                                        親フォーム: LookUp(
                                            基本情報,
                                            フォームNo = loc_LastSubmit.フォームNo
                                        ),
                                        選択数制御: Local.limitCount,
                                        選択肢制御タイプ: Switch(
                                            Local.limitType,
                                            "無し",
                                            [@選択肢制御タイプ].無し,
                                            "指定数",
                                            [@選択肢制御タイプ].指定数,
                                            "指定数以下",
                                            [@選択肢制御タイプ].指定数以下
                                        )
                                    }
                                );
                                With(
                                    {
                                        ItemID: LookUp(
                                            項目定義,
                                            親フォーム.フォームNo = loc_LastSubmit.フォームNo && 項目番号 = Local.order
                                        )
                                    },
                                    If(
                                        Local.type = "Yes/No形式" || Local.type = "択一形式" || Local.type = "複数選択形式",
                                        ForAll(
                                            Filter(
                                                col_selectItem,
                                                order = Local.order
                                            ) As LocalSelectItem,
                                            Patch(
                                                選択肢列,
                                                Defaults(選択肢列),
                                                {
                                                    親項目: ItemID,
                                                    選択内容: LocalSelectItem.name,
                                                    選択順序: LocalSelectItem.id
                                                }
                                            )
                                        )
                                    )
                                ),
                                //データ更新
                                Patch(
                                    項目定義,
                                    LookUp(
                                        項目定義,
                                        項目ID = Local.unique
                                    ),
                                    {
                                        項目形態: Switch(
                                            Local.type,
                                            "Yes/No形式",
                                            [@項目形態].'Yes/No形式',
                                            "択一形式",
                                            [@項目形態].択一形式,
                                            "複数選択形式",
                                            [@項目形態].複数選択形式,
                                            "添付ファイル形式",
                                            [@項目形態].添付ファイル形式,
                                            [@項目形態].自由入力形式
                                        ),
                                        CSV出力項目: Local.csv,
                                        内容: Local.contents,
                                        必須: Local.required,
                                        項目番号: Local.order,
                                        選択数: Local.num,
                                        親フォーム: LookUp(
                                            基本情報,
                                            フォームNo = loc_LastSubmit.フォームNo
                                        ),
                                        選択数制御: Local.limitCount,
                                        選択肢制御タイプ: Switch(
                                            Local.limitType,
                                            "無し",
                                            [@選択肢制御タイプ].無し,
                                            "指定数",
                                            [@選択肢制御タイプ].指定数,
                                            "指定数以下",
                                            [@選択肢制御タイプ].指定数以下
                                        )
                                    }
                                );
                                If(
                                    Local.type = "Yes/No形式" || Local.type = "択一形式" || Local.type = "複数選択形式",
                                    ForAll(
                                        Filter(
                                            col_selectItem,
                                            order = Local.order
                                        ) As LocalSelectItem,
                                        Patch(
                                            選択肢列,
                                            LookUp(
                                                選択肢列,
                                                選択肢ID = LocalSelectItem.unique
                                            ),
                                            {
                                                親項目: LookUp(
                                                    項目定義,
                                                    項目ID = Local.unique
                                                ),
                                                選択内容: LocalSelectItem.name,
                                                選択順序: LocalSelectItem.id
                                            }
                                        )
                                    )
                                )
                            )
                        );
                        ForAll(
                            col_deleteFormItem As deleteItem,
                            If(
                                !IsBlank(
                                    LookUp(
                                        項目定義,
                                        項目ID = deleteItem.unique
                                    )
                                ),
                                If(
                                    deleteItem.type = "Yes/No形式" || deleteItem.type = "択一形式" || deleteItem.type = "複数選択形式",
                                    ForAll(
                                        Filter(
                                            col_selectItem,
                                            order = deleteItem.order
                                        ) As LocalSelectItem,
                                        Remove(
                                            選択肢列,
                                            LookUp(
                                                選択肢列,
                                                選択肢ID = LocalSelectItem.unique
                                            )
                                        )
                                    )
                                );
                                Remove(
                                    項目定義,
                                    LookUp(
                                        項目定義,
                                        項目ID = deleteItem.unique
                                    )
                                )
                            )
                        );
                        フォーム制定部室店承認完了通知WF.Run(loc_LastSubmit.フォームNo);
                        Refresh(基本情報);
                        Navigate('Form Gallery Screen',Fade)
                    Text: ="承認"
                    Visible: =Text(DataCardValue3.Selected.Value) = "承認待ち"
                    X: =476
                    Y: =40
                    ZIndex: =4

    Arr_BackSIFS_1 As arrow.backArrow:
        Fill: =RGBA(255, 255, 255, 1)
        OnSelect: =Back()
        X: =44
        Y: =12
        ZIndex: =9

